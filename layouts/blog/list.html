{{ define "main" }}
{{- with .Content -}}
  {{ . }}
{{- end -}}

{{- $sections := default (slice "posts") .Site.Params.mainSections -}}
{{- $pages := where .Site.RegularPages "Section" "in" $sections -}}
{{- $groupedPages := ($pages.ByDate.Reverse).GroupByDate "2006" -}}

{{- if gt (len $groupedPages) 0 -}}
<div class="blog-archive">
  {{- range $groupedPages -}}
  <section class="blog-archive-year">
    <h2 class="blog-archive-year-title">{{ .Key }}</h2>
    <ul class="blog-archive-list">
      {{- range .Pages.ByDate.Reverse -}}
      <li class="blog-archive-item">
        <time class="blog-archive-date" datetime="{{ .Date | time.Format "2006-01-02" }}">
          {{ partial "date/format.html" (dict "page" . "date" .Date "context" "list") }}
        </time>
        <a class="blog-archive-link" href="{{ .RelPermalink }}">{{ .Title }}</a>
      </li>
      {{- end -}}
    </ul>
  </section>
  {{- end -}}
</div>
{{- else -}}
<p>{{ i18n "no_posts_yet" }}</p>
{{- end -}}
{{ end }}
