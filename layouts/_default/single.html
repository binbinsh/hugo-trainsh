{{ define "main" }}
<article class="prose max-w-none content">
  <header class="mb-8">
    <h1 class="text-3xl font-bold mb-2">{{ .Title }}</h1>
    <div class="flex flex-wrap items-center gap-4 text-sm text-[var(--color-muted)]">
      <time datetime="{{ .Date | time.Format "2006-01-02" }}">
        {{ partial "date/format.html" (dict "page" . "date" .Date "style" "long_full") }}
      </time>
    </div>
  </header>

  {{ $tocEnabled := true }}
  {{ if isset site.Params "toc" }}{{ $tocEnabled = site.Params.toc }}{{ end }}
  {{ if isset .Params "toc" }}{{ $tocEnabled = .Params.toc }}{{ end }}

  {{ $toc := .Fragments.ToHTML 2 3 false }}
  {{ $hasToc := false }}
  {{ range .Fragments.Headings }}
    {{ if or (eq .Level 2) (eq .Level 3) }}{{ $hasToc = true }}{{ end }}
    {{ range .Headings }}
      {{ if or (eq .Level 2) (eq .Level 3) }}{{ $hasToc = true }}{{ end }}
    {{ end }}
  {{ end }}

  {{ if and $tocEnabled $hasToc }}
  <details class="mb-8 p-4 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg">
    <summary class="cursor-pointer font-semibold">{{ i18n "toc" }}</summary>
    <nav class="mt-4 text-sm">
      {{ $toc }}
    </nav>
  </details>
  {{ end }}

  <div class="[&>p]:mb-4 [&>p]:leading-relaxed [&>h2]:text-2xl [&>h2]:font-semibold [&>h2]:mt-8 [&>h2]:mb-4 [&>h3]:text-xl [&>h3]:font-semibold [&>h3]:mt-6 [&>h3]:mb-3 [&>ul]:list-disc [&>ul]:pl-6 [&>ul]:mb-4 [&>ol]:list-decimal [&>ol]:pl-6 [&>ol]:mb-4 [&>li]:mb-1">
    {{ .Content }}
  </div>

  {{ partial "post/footer-meta.html" . }}
</article>
{{ end }}
