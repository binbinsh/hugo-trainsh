{{- .Page.Store.Set "hasCode" true -}}

{{- $file := or .Attributes.file "" -}}
{{- $ext := strings.TrimPrefix "." (path.Ext $file) -}}
{{- $lang := or .Type $ext "text" -}}
{{- if in (slice "html" "gotmpl") $lang -}}
  {{- $lang = "go-html-template" -}}
{{- end -}}
{{- $label := cond (eq $lang "text") "plain text" $lang -}}

{{- $opts := dict "linenos" false "lineNumbersInTable" false "anchorLineNos" false "noClasses" false "guessSyntax" true -}}

<div class="my-4 rounded-lg overflow-hidden border border-[var(--color-border)]">
  <div class="flex items-center justify-between px-4 py-2 bg-[var(--color-surface)] border-b border-[var(--color-border)]">
    <span class="text-sm text-[var(--color-muted)]">{{ $label }}</span>
    <button type="button" data-copy-code aria-label="Copy code" class="text-sm px-2 py-1 rounded hover:bg-[var(--color-code-bg)] transition-colors cursor-pointer">
      Copy
    </button>
  </div>
  <div class="overflow-x-auto">
    {{- transform.Highlight (strings.TrimSpace .Inner) $lang $opts -}}
  </div>
</div>
