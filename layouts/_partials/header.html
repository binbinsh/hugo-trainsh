<div class="site-header">
  {{- $tagsPage := .Site.GetPage "/tags" -}}
  {{- $tagsLabel := i18n "tags" -}}
  {{- if hasPrefix .Site.Language.Lang "zh" -}}
    {{- $tagsLabel = i18n "tag_archive" -}}
  {{- end -}}
  <div class="site-brand">
    <a class="title" href="{{ "/" | relLangURL }}">
      <h1>{{ .Site.Title }}</h1>
    </a>
  </div>

  <nav class="site-nav">
    {{- with site.Params.nav -}}
    {{- $html := . | markdownify -}}
    {{- $html = replaceRE `(?s)^<p>(.*)</p>$` `$1` $html -}}
    {{- $html | safeHTML -}}
    {{- else -}}
    {{ with site.Menus.main }}
    {{- $hasTagsLink := false -}}
    {{ range $i, $item := . }}
    {{- if and $tagsPage (eq $item.URL $tagsPage.RelPermalink) -}}
      {{- $hasTagsLink = true -}}
    {{- end -}}
    {{- with $item.Page -}}
      {{- if and $tagsPage (eq .RelPermalink $tagsPage.RelPermalink) -}}
        {{- $hasTagsLink = true -}}
      {{- end -}}
    {{- end -}}
    {{ if $i }} {{ end }}<a href="{{ $item.URL }}">{{ $item.Name }}</a>
    {{ end }}
    {{- if and $tagsPage (not $hasTagsLink) -}}
    <a href="{{ $tagsPage.RelPermalink }}">{{ $tagsLabel }}</a>
    {{- end -}}
    {{ else }}
    <a href="{{ "/" | relLangURL }}">{{ i18n "home" }}</a>
    {{ with site.GetPage "/blog" }}
    <a href="{{ .RelPermalink }}">{{ i18n "blog" }}</a>
    {{ end }}
    {{ with $tagsPage }}
    <a href="{{ .RelPermalink }}">{{ $tagsLabel }}</a>
    {{ end }}
    {{ end }}
    {{- end -}}
  </nav>
  <button class="theme-toggle" type="button" aria-label="Toggle theme" title="Toggle theme">
    <svg class="icon-sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="12" cy="12" r="5" />
      <line x1="12" y1="1" x2="12" y2="3" />
      <line x1="12" y1="21" x2="12" y2="23" />
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64" />
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78" />
      <line x1="1" y1="12" x2="3" y2="12" />
      <line x1="21" y1="12" x2="23" y2="12" />
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36" />
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22" />
    </svg>
    <svg class="icon-moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" />
    </svg>
  </button>
</div>
